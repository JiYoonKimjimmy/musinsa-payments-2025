# 무신사페이먼츠 Backend Engineer 과제 전형

### 무료 포인트 시스템 (API)

1. 내용
    1. 아래 기능을 만족하는 무료포인트 시스템(API)를 개발해야 하며 github에 올려주시면 됩니다. (필수)
    2. ERD 를 PDF 또는 이미지 파일등의 형식으로 resource 하위에 포함해 주세요. (필수)
    3. AWS 기반으로 서비스한다고 가정했을때의 아키텍처 구성을 PDF 또는 이미지 파일형식으로 resource 하위에 포함해 주세요 (옵션)
    4. 빌드 방법과 과제 설명등은 README.md 파일에 작성해 주세요. (필수)
2. 개발 환경 : Java 21, springboot 3.x, H2
3. 필요 기능 : 적립, 적립취소, 사용, 사용취소
    1. 적립
        1. 1회 적립가능 포인트는 1포인트 이상, 10만포인트 이하로 가능하며 1회 최대 적립가능 포인트는 하드코딩이 아닌 방법으로 제어할수 있어야 한다.
        2. 개인별로 보유 가능한 무료포인트의 최대금액 제한이 존재하며, 하드코딩이 아닌 별도의 방법으로 변경할 수 있어야 한다.
        3. 특정 시점에 적립된 포인트는 1원단위까지 어떤 주문에서 사용되었는지 추적할수 있어야 한다.
        4. 포인트 적립은 관리자가 수기로 지급할 수 있으며, 수기지급한 포인트는 다른 적립과 구분되어 식별할 수 있어야 한다.
        5. 모든 포인트는 만료일이 존재하며, 최소 1일이상 최대 5년 미만의 만료일을 부여할 수 있다. (기본 365일)
    2. 적립 취소
        1. 특정 적립행위에서 적립한 금액만큼 취소 가능하며, 적립한 금액중 일부가 사용된 경우라면 적립 취소 될 수 없다.
    3. 사용
        1. 주문시에만 포인트를 사용할 수 있다고 가정한다.
        2. 포인트 사용시에는 주문번호를 함께 기록하여 어떤 주문에서 얼마의 포인트를 사용했는지 식별할 수 있어야 한다.
        3. 포인트 사용시에는 관리자가 수기 지급한 포인트가 우선 사용되어야 하며, 만료일이 짧게 남은 순서로 사용해야 한다.
    4. 사용 취소
        1. 사용한 금액중 전제 또는 일부를 사용취소 할수 있다.
        2. 사용취소 시점에 이미 만료된 포인를 사용취소 해야 한다면 그 금액만큼 신규적립 처리 한다.
4. 예시
    1. 1000원 적립한다 (총 잔액 0 -> 1000 원)
        1. pointKey : A 로 할당
    2. 500원 적립한다 (총 잔액 1000 -> 1500 원)
        1. pointKey : B 로 할당
    3. 주문번호 A1234 에서 1200원 사용한다 (총 잔액 1500 -> 300 원)
        1. pointKey : C 로 할당
        2. A 적립에서 1000원 사용함 -> A의 사용가능 잔액은 1000 -> 0
        3. B 적립에서 200원 사용함 -> B의 사용가능 잔액은 500 -> 300
    4. A의 적립이 만료되었다
    5. C의 사용금액 1200원 중 1100원을 부분 사용취소 한다 (총 잔액 300 -> 1400 원)
        1. pointKey : D 로 할당
        2. 1200원은 A와 B에서 사용되었다.
        3. 그래서, 사용취소 하면 A의 사용가능 잔액이 0 -> 1000원 되어야 하지만, A는 이미 만료일이 지났기 때문에 pointKey E 로 1000원이 신규적립 되어야 한다.
        4. B는 만료되지 않았기 때문에 사용가능 잔액은 300 -> 400원이 된다.
        5. C는 이제 1200원 사용금액중 100원을 부분취소 할 수 있다.