# λ¬΄μ‹ μ‚¬νμ΄λ¨ΌμΈ  ν¬μΈνΈ μ‹μ¤ν…

## λ©μ°¨

1. [ν”„λ΅μ νΈ κ°μ”](#ν”„λ΅μ νΈ-κ°μ”)
2. [κΈ°μ  μ¤νƒ](#κΈ°μ -μ¤νƒ)
3. [λΉλ“ λ° μ‹¤ν–‰](#λΉλ“-λ°-μ‹¤ν–‰)
4. [API λ¬Έμ„](#api-λ¬Έμ„)
5. [κ³Όμ  μ”κµ¬μ‚¬ν•­ μ¶©μ΅± μ‚¬ν•­](#κ³Όμ -μ”κµ¬μ‚¬ν•­-μ¶©μ΅±-μ‚¬ν•­)
6. [ERD λ° μ•„ν‚¤ν…μ²](#erd-λ°-μ•„ν‚¤ν…μ²)
7. [ν”„λ΅μ νΈ κµ¬μ΅°](#ν”„λ΅μ νΈ-κµ¬μ΅°)

---

## ν”„λ΅μ νΈ κ°μ”

λ¬΄λ£ ν¬μΈνΈ μ λ¦½/μ‚¬μ©/μ·¨μ† κΈ°λ¥μ„ μ κ³µν•λ” λ°±μ—”λ“ API μ‹μ¤ν…μ…λ‹λ‹¤.

### μ£Όμ” κΈ°λ¥

| κΈ°λ¥        | μ„¤λ…                                  |
|-----------|-------------------------------------|
| ν¬μΈνΈ μ λ¦½    | 1ν¬μΈνΈ λ‹¨μ„ μ‚¬μ© μ¶”μ , μκΈ° μ§€κΈ‰ κµ¬λ¶„, λ§λ£μΌ κ΄€λ¦¬     |
| ν¬μΈνΈ μ λ¦½ μ·¨μ† | λ―Έμ‚¬μ© μ λ¦½ κ±΄ μ „μ²΄ μ·¨μ†                      |
| ν¬μΈνΈ μ‚¬μ©    | μκΈ° μ§€κΈ‰ μ°μ„  β†’ λ§λ£μΌ μ§§μ€ μμΌλ΅ μ‚¬μ©            |
| ν¬μΈνΈ μ‚¬μ© μ·¨μ† | μ „μ²΄/λ¶€λ¶„ μ·¨μ†, λ§λ£ ν¬μΈνΈλ” μ‹ κ· μ λ¦½ μ²λ¦¬          |
| μ”μ•΅/λ‚΄μ—­ μ΅°ν  | νμ›λ³„ μ”μ•΅ μ΅°ν, μ£Όλ¬Έλ³„ μ‚¬μ© λ‚΄μ—­ μ΅°ν             |

### ν•µμ‹¬ νΉμ§•

- **1ν¬μΈνΈ λ‹¨μ„ μ¶”μ **: μ–΄λ–¤ μ λ¦½ κ±΄μ—μ„ μ–Όλ§λ¥Ό μ‚¬μ©ν–λ”μ§€ μ¶”μ 
- **λ™μ  μ„¤μ • κ΄€λ¦¬**: 1ν μµλ€ μ λ¦½ κΈμ•΅, κ°μΈλ³„ μµλ€ λ³΄μ  κΈμ•΅ λ“± λ°νƒ€μ„ λ³€κ²½ κ°€λ¥
- **μ‚¬μ© μ°μ„ μμ„**: μκΈ° μ§€κΈ‰ ν¬μΈνΈ μ°μ„ , κ·Έ λ‹¤μ λ§λ£μΌ μ§§μ€ μ
- **λ§λ£ ν¬μΈνΈ μ²λ¦¬**: μ‚¬μ© μ·¨μ† μ‹ λ§λ£λ ν¬μΈνΈλ” μ‹ κ· μ λ¦½μΌλ΅ μ²λ¦¬

---

## κΈ°μ  μ¤νƒ

| κµ¬λ¶„     | κΈ°μ                                  |
|--------|------------------------------------|
| μ–Έμ–΄     | Kotlin, Java 21                    |
| ν”„λ μ„μ›ν¬  | Spring Boot 3.5.7, Spring Data JPA |
| λ°μ΄ν„°λ² μ΄μ¤ | H2 (κ°λ°), PostgreSQL (μ΄μ κ¶μ¥)        |
| λΉλ“     | Gradle 8.14.3                      |
| ν…μ¤νΈ    | Kotest, MockK                      |
| λ¬Έμ„ν™”    | SpringDoc OpenAPI 3 (Swagger)      |
| μ•„ν‚¤ν…μ²   | ν—¥μ‚¬κ³ λ‚  μ•„ν‚¤ν…μ² (Hexagonal Architecture) |

---

## λΉλ“ λ° μ‹¤ν–‰

### μ‚¬μ „ μ”κµ¬μ‚¬ν•­

- JDK 21

### λΉλ“ λ° μ‹¤ν–‰

```bash
# λΉλ“
./gradlew build

# μ‹¤ν–‰
./gradlew bootRun

# λλ” JAR μ‹¤ν–‰
java -jar build/libs/musinsa-payments-0.0.1-SNAPSHOT.jar
```

### μ ‘μ† μ •λ³΄

| ν•­λ©         | URL                                         |
|------------|---------------------------------------------|
| API μ„λ²„     | http://localhost:8080                       |
| Swagger UI | http://localhost:8080/swagger-ui/index.html |
| H2 μ½μ†”      | http://localhost:8080/h2-console            |

> H2 μ ‘μ†: JDBC URL `jdbc:h2:mem:testdb`, Username `sa`, Password μ—†μ

### μ΄κΈ° μ„¤μ •κ°’

| μ„¤μ • ν‚¤                             | κΈ°λ³Έκ°’        | μ„¤λ…            |
|----------------------------------|------------|---------------|
| MAX_ACCUMULATION_AMOUNT_PER_TIME | 100,000    | 1ν μµλ€ μ λ¦½ κΈμ•΅   |
| MAX_BALANCE_PER_MEMBER           | 10,000,000 | κ°μΈλ³„ μµλ€ λ³΄μ  κΈμ•΅  |
| DEFAULT_EXPIRATION_DAYS          | 365        | κΈ°λ³Έ λ§λ£μΌ        |
| MIN_EXPIRATION_DAYS              | 1          | μµμ† λ§λ£μΌ        |
| MAX_EXPIRATION_DAYS              | 1,824      | μµλ€ λ§λ£μΌ (μ•½ 5λ…„) |

---

## API λ¬Έμ„

### μ£Όμ” μ—”λ“ν¬μΈνΈ

| λ©”μ„λ“  | μ—”λ“ν¬μΈνΈ                                      | μ„¤λ…          |
|------|--------------------------------------------|-------------|
| POST | `/api/points/accumulate`                   | ν¬μΈνΈ μ λ¦½      |
| POST | `/api/points/accumulate/{pointKey}/cancel` | μ λ¦½ μ·¨μ†       |
| POST | `/api/points/use`                          | ν¬μΈνΈ μ‚¬μ©      |
| POST | `/api/points/use/{pointKey}/cancel`        | μ‚¬μ© μ·¨μ†       |
| GET  | `/api/points/balance/{memberId}`           | μ”μ•΅ μ΅°ν       |
| GET  | `/api/points/history/{memberId}`           | μ‚¬μ© λ‚΄μ—­ μ΅°ν    |
| GET  | `/api/admin/points/config`                 | μ„¤μ • μ΅°ν (κ΄€λ¦¬μ) |
| PUT  | `/api/admin/points/config/{configKey}`     | μ„¤μ • λ³€κ²½ (κ΄€λ¦¬μ) |

### API μ‚¬μ© μμ‹

```bash
# ν¬μΈνΈ μ λ¦½
curl -X POST http://localhost:8080/api/points/accumulate \
  -H "Content-Type: application/json" \
  -d '{"memberId": 1, "amount": 1000, "expirationDays": 365, "isManualGrant": false}'

# ν¬μΈνΈ μ‚¬μ©
curl -X POST http://localhost:8080/api/points/use \
  -H "Content-Type: application/json" \
  -d '{"memberId": 1, "orderNumber": "A1234", "amount": 500}'

# μ”μ•΅ μ΅°ν
curl http://localhost:8080/api/points/balance/1
```

> μ „μ²΄ API λ¬Έμ„λ” Swagger UIμ—μ„ ν™•μΈν•μ„Έμ”: http://localhost:8080/swagger-ui/index.html

---

## κ³Όμ  μ”κµ¬μ‚¬ν•­ μ¶©μ΅± μ‚¬ν•­

### β… κΈ°λ¥ μ”κµ¬μ‚¬ν•­

| μ”κµ¬μ‚¬ν•­                    | κµ¬ν„ | μ„¤λ…                                       |
|-------------------------|:--:|------------------------------------------|
| 1ν μ λ¦½ κ°€λ¥ λ²”μ„ (1~10λ§ ν¬μΈνΈ) | β…  | `MAX_ACCUMULATION_AMOUNT_PER_TIME` λ™μ  μ„¤μ • |
| κ°μΈλ³„ μµλ€ λ³΄μ  κΈμ•΅ μ ν•         | β…  | `MAX_BALANCE_PER_MEMBER` λ™μ  μ„¤μ •           |
| 1ν¬μΈνΈ λ‹¨μ„ μ‚¬μ© μ¶”μ            | β…  | `PointUsageDetail` μ—”ν‹°ν‹°λ΅ μƒμ„Έ κΈ°λ΅            |
| μκΈ° μ§€κΈ‰ ν¬μΈνΈ κµ¬λ¶„            | β…  | `isManualGrant` ν•„λ“λ΅ κµ¬λ¶„                   |
| λ§λ£μΌ κ΄€λ¦¬ (1μΌ~5λ…„)          | β…  | μ λ¦½ μ‹ λ§λ£μΌ κ²€μ¦, κΈ°λ³Έ 365μΌ                     |
| μ λ¦½ μ·¨μ† (λ―Έμ‚¬μ© μ‹λ§ κ°€λ¥)       | β…  | μ‚¬μ©λ κΈμ•΅ μμΌλ©΄ μ·¨μ† λ¶κ°€                         |
| μ‚¬μ© μ°μ„ μμ„ (μκΈ°β†’λ§λ£μΌ μ§§μ€ μ)   | β…  | `PointUsagePriorityService` κµ¬ν„           |
| μ‚¬μ© μ·¨μ† (μ „μ²΄/λ¶€λ¶„)           | β…  | λ¶€λ¶„ μ·¨μ† κ°€λ¥, μ—¬λ¬ λ² μ·¨μ† κ°€λ¥                     |
| λ§λ£ ν¬μΈνΈ μ‚¬μ© μ·¨μ† μ‹ μ‹ κ· μ λ¦½    | β…  | λ§λ£λ ν¬μΈνΈλ” μƒ pointKeyλ΅ μ λ¦½                  |

### β… κΈ°μ  μ”κµ¬μ‚¬ν•­

| μ”κµ¬μ‚¬ν•­              | κµ¬ν„ | μ„¤λ…                              |
|-------------------|:--:|---------------------------------|
| Java 21           | β…  | Kotlin + Java 21                |
| Spring Boot 3.x   | β…  | Spring Boot 3.5.7               |
| H2 Database       | β…  | μΈλ©”λ¨λ¦¬ DB μ‚¬μ©                      |
| ERD λ‹¤μ΄μ–΄κ·Έλ¨         | β…  | `resource/erd.svg`              |
| AWS μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨    | β…  | `resource/aws-architecture.svg` |
| README (λΉλ“/κ³Όμ  μ„¤λ…) | β…  | ν„μ¬ λ¬Έμ„                           |

### π“ μμ‹ μ‹λ‚λ¦¬μ¤ κµ¬ν„

```
1. 1000μ› μ λ¦½ (A) β†’ μ”μ•΅: 1000μ›
2. 500μ› μ λ¦½ (B)  β†’ μ”μ•΅: 1500μ›
3. 1200μ› μ‚¬μ© (C) β†’ Aμ—μ„ 1000μ› + Bμ—μ„ 200μ› μ‚¬μ© β†’ μ”μ•΅: 300μ›
4. A μ λ¦½ λ§λ£
5. 1100μ› μ‚¬μ© μ·¨μ† (D)
   - A(λ§λ£): 1000μ› μ‹ κ· μ λ¦½ (E)
   - B(μ ν¨): 100μ› μ”μ•΅ λ³µμ›
   β†’ μ”μ•΅: 1400μ›
```

---

## ERD λ° μ•„ν‚¤ν…μ²

### ERD λ‹¤μ΄μ–΄κ·Έλ¨

![ERD λ‹¤μ΄μ–΄κ·Έλ¨](resource/erd.svg)

### AWS μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨

![AWS μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨](resource/aws-architecture.svg)

### μ„¤κ³„ λ¬Έμ„

| λ¬Έμ„                                                         | μ„¤λ…               |
|------------------------------------------------------------|------------------|
| [01-λ„λ©”μΈ-λ¶„μ„.md](docs/01-λ„λ©”μΈ-λ¶„μ„.md)                          | λ„λ©”μΈ λ¶„μ„ λ° μ”κµ¬μ‚¬ν•­    |
| [02-ERD-μ„¤κ³„.md](docs/02-ERD-μ„¤κ³„.md)                          | λ°μ΄ν„°λ² μ΄μ¤ μ„¤κ³„        |
| [03-λ„λ©”μΈ-λ¨λΈ-μ„¤κ³„.md](docs/03-λ„λ©”μΈ-λ¨λΈ-μ„¤κ³„.md)                    | λ„λ©”μΈ λ¨λΈ μ„¤κ³„        |
| [04-API-μ„¤κ³„.md](docs/04-API-μ„¤κ³„.md)                          | REST API μ„¤κ³„      |
| [05-λΉ„μ¦λ‹μ¤-λ΅μ§-μ„¤κ³„.md](docs/05-λΉ„μ¦λ‹μ¤-λ΅μ§-μ„¤κ³„.md)                  | λΉ„μ¦λ‹μ¤ λ΅μ§ μ„¤κ³„       |
| [06-μ„¤μ •-κ΄€λ¦¬-μ„¤κ³„.md](docs/06-μ„¤μ •-κ΄€λ¦¬-μ„¤κ³„.md)                      | μ„¤μ • κ΄€λ¦¬ μ„¤κ³„         |
| [07-ν”„λ΅μ νΈ-κµ¬μ΅°-μ„¤κ³„.md](docs/07-ν”„λ΅μ νΈ-κµ¬μ΅°-μ„¤κ³„.md)                  | ν”„λ΅μ νΈ κµ¬μ΅° μ„¤κ³„       |
| [08-AWS-μ•„ν‚¤ν…μ²-μ„¤κ³„.md](docs/08-AWS-μ•„ν‚¤ν…μ²-μ„¤κ³„.md)                | AWS μ•„ν‚¤ν…μ² μ„¤κ³„      |
| [09-ν…μ¤νΈ-μ „λµ.md](docs/09-ν…μ¤νΈ-μ „λµ.md)                          | ν…μ¤νΈ μ „λµ           |
| [10-λ¬Έμ„ν™”-κ³„ν.md](docs/10-λ¬Έμ„ν™”-κ³„ν.md)                          | λ¬Έμ„ν™” κ³„ν           |
| [11-ν–¥ν›„-κ°μ„ -μ‚¬ν•­.md](docs/11-ν–¥ν›„-κ°μ„ -μ‚¬ν•­.md)                      | ν–¥ν›„ κ°μ„  μ‚¬ν•­ (λ¶„μ‚°λ½ λ“±) |

---

## ν”„λ΅μ νΈ κµ¬μ΅°

```
com.musinsa.payments.point
β”β”€β”€ domain                   # λ„λ©”μΈ λ μ΄μ–΄ (ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§)
β”‚   β”β”€β”€ entity               # λ„λ©”μΈ μ—”ν‹°ν‹°
β”‚   β”β”€β”€ valueobject          # κ°’ κ°μ²΄ (Money, PointKey λ“±)
β”‚   β”β”€β”€ service              # λ„λ©”μΈ μ„λΉ„μ¤
β”‚   β””β”€β”€ exception            # λ„λ©”μΈ μμ™Έ
β”β”€β”€ application              # μ• ν”λ¦¬μΌ€μ΄μ… λ μ΄μ–΄ (μ μ¤μΌ€μ΄μ¤)
β”‚   β”β”€β”€ port/input           # μΈλ°”μ΄λ“ ν¬νΈ (Use Case)
β”‚   β”β”€β”€ port/output          # μ•„μ›ƒλ°”μ΄λ“ ν¬νΈ (μμ†μ„±, μ„¤μ •)
β”‚   β”β”€β”€ service              # μ• ν”λ¦¬μΌ€μ΄μ… μ„λΉ„μ¤
β”‚   β””β”€β”€ event                # μ΄λ²¤νΈ ν•Έλ“¤λ¬
β”β”€β”€ infrastructure           # μΈν”„λΌ λ μ΄μ–΄ (μ™Έλ¶€ μ‹μ¤ν…)
β”‚   β”β”€β”€ persistence          # JPA μ—”ν‹°ν‹°, λ¦¬ν¬μ§€ν† λ¦¬, μ–΄λ‘ν„°
β”‚   β”β”€β”€ config               # μ„¤μ • μ–΄λ‘ν„°
β”‚   β””β”€β”€ event                # μ΄λ²¤νΈ λ°ν–‰μ
β””β”€β”€ presentation             # ν”„λ μ  ν…μ΄μ… λ μ΄μ–΄
    β””β”€β”€ web                  # REST μ»¨νΈλ΅¤λ¬, DTO
```

### μμ΅΄μ„± λ°©ν–¥

```
Presentation β†’ Application β†’ Domain
                    β†“          β†‘
Infrastructure β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## ν…μ¤νΈ

```bash
# μ „μ²΄ ν…μ¤νΈ μ‹¤ν–‰
./gradlew test

# μ»¤λ²„λ¦¬μ§€ λ¦¬ν¬νΈ
./gradlew test jacocoTestReport
# λ¦¬ν¬νΈ μ„μΉ: build/reports/jacoco/test/html/index.html
```

---

## λΌμ΄μ„ μ¤

λ¬΄μ‹ μ‚¬νμ΄λ¨ΌμΈ  Backend Engineer κ³Όμ  μ „ν•μ„ μ„ν• ν”„λ΅μ νΈμ…λ‹λ‹¤.
